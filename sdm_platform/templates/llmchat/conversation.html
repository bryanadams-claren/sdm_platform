{% extends "base.html" %}

{% block body %}
  <div class="chat-layout">
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="sidebar-header">
        <button id="newChatBtn"
                class="btn btn-success w-100"
                data-bs-toggle="modal"
                data-bs-target="#newChatModal">+ New Chat</button>
      </div>
      <div class="chat-list" id="chatList">
        {% for conv in conversations %}
          {% if conv.chat_id == active_chat_id %}
            <div class="chat-item active" data-id="{{ conv.conv_id }}">{{ conv.title|default:"Untitled Conversation" }}</div>
          {% else %}
            <div class="chat-item" data-id="{{ conv.conv_id }}">{{ conv.title|default:"Untitled Conversation" }}</div>
          {% endif %}
        {% endfor %}
      </div>
      <div class="user-info d-flex align-items-center">
        {#        <img src="https://via.placeholder.com/40"
             class="rounded-circle me-2"
             alt="User" />#}
        <div>
          <strong>{{ request.user.name }}</strong>
          <br />
          <small>Settings</small>
        </div>
      </div>
    </div>
    <!-- Chat Panel -->
    <div class="chat-panel">
      <div id="chatMessages" class="chat-messages">
        <div class="message bot">
          <div class="msg-text">ðŸ‘‹ Loadingâ€¦</div>
        </div>
      </div>
      <div class="chat-input">
        <div class="input-group">
          <input id="chatInput"
                 type="text"
                 class="form-control"
                 placeholder="Type a message..." />
          <button id="sendBtn" class="btn btn-primary">Send</button>
        </div>
      </div>
    </div>
  </div>
  <div class="modal fade"
       id="newChatModal"
       tabindex="-1"
       aria-labelledby="newChatModalLabel"
       aria-hidden="true">
    <div class="modal-dialog">
      <form class="modal-content" id="newChatForm">
        <div class="modal-header">
          <h5 class="modal-title" id="newChatModalLabel">Start New Chat</h5>
          <button type="button"
                  class="btn-close"
                  data-bs-dismiss="modal"
                  aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label for="chatSubject" class="form-label">Subject</label>
            <input type="text"
                   class="form-control"
                   id="chatSubject"
                   placeholder="Enter chat subject"
                   required />
          </div>
        </div>
        <div class="modal-footer">
          <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}" />
          <button type="submit" class="btn btn-success">Create Chat</button>
        </div>
      </form>
    </div>
  </div>
{% endblock body %}
